–ú—ã –≤—Å–µ –ª—é–±–∏–º push_back. –≠—Ç–æ —É–¥–æ–±–Ω–æ: –ø—Ä–æ—Å—Ç–æ –∫–∏–¥–∞–µ—à—å –¥–∞–Ω–Ω—ã–µ –≤ –≤–µ–∫—Ç–æ—Ä, –∞ –æ–Ω —Å–∞–º —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è —Å –ø–∞–º—è—Ç—å—é. –ù–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ —ç–ª–µ–º–µ–Ω—Ç, –∞ –º–µ—Å—Ç–æ (capacity) –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å?

–ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –†–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è ([[Reallocation]]). –ò —ç—Ç–æ –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ¬´–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º¬ª?
1. *–ü–æ–∏—Å–∫ –Ω–æ–≤–æ–π –∑–µ–º–ª–∏:* –í–µ–∫—Ç–æ—Ä –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –±—É—Ñ–µ—Ä –ø–æ–ª–æ–Ω. –û–Ω –ø—Ä–æ—Å–∏—Ç —É –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤—ã–¥–µ–ª–∏—Ç—å –Ω–æ–≤—ã–π –±–ª–æ–∫ –ø–∞–º—è—Ç–∏. –û–±—ã—á–Ω–æ –æ–Ω –≤ 1.5 –∏–ª–∏ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ (–≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ä–æ—Å—Ç).
2. *–í–µ–ª–∏–∫–æ–µ –ø–µ—Ä–µ—Å–µ–ª–µ–Ω–∏–µ:* –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –±–ª–æ–∫–∞ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è (–∏–ª–∏ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è, –µ—Å–ª–∏ –µ—Å—Ç—å *noexcept move-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä*) –≤ –Ω–æ–≤—ã–π –±–ª–æ–∫.
3. *–ó–∞—á–∏—Å—Ç–∫–∞:* –î–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å—Ç–∞—Ä–æ–º –±–ª–æ–∫–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã.
4. *–°–Ω–æ—Å:* –°—Ç–∞—Ä–∞—è –ø–∞–º—è—Ç—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–µ.

–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞?
1. *–£–¥–∞—Ä –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:*
–û–±—ã—á–Ω–æ `push_back` —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ –∞–º–æ—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ O(1) (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ). –ù–æ –≤ –º–æ–º–µ–Ω—Ç —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥—Å–∫–∞–∫–∏–≤–∞–µ—Ç –¥–æ O(N). –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –ª–∞–≥–∏ (*latency spikes*).
2. *–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ —Å—Å—ã–ª–æ–∫ (–û–ü–ê–°–ù–û):*
–≠—Ç–æ –∏—Å—Ç–æ—á–Ω–∏–∫ –±–∞–≥–æ–≤ ‚Ññ1. –ü–æ—Å–ª–µ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ä–∞—è –ø–∞–º—è—Ç—å —É–¥–∞–ª–µ–Ω–∞. –í—Å–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏, —Å—Å—ã–ª–∫–∏ –∏ –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–º–æ—Ç—Ä–µ–ª–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–µ–∫—Ç–æ—Ä–∞, —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏.

```c++
std::vector<int> vec = {1, 2, 3};
int& ref = vec[0]; // –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç

// ... –¥–æ–±–∞–≤–ª—è–µ–º –º–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –≤—ã–∑—ã–≤–∞—è —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—é ...
for(int i=0; i < 100; ++i) vec.push_back(i);

// üí• –í–µ–∫—Ç–æ—Ä –ø–µ—Ä–µ–µ—Ö–∞–ª. –°—Ç–∞—Ä–∞—è –ø–∞–º—è—Ç—å —É–¥–∞–ª–µ–Ω–∞. 
// ref —Ç–µ–ø–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –º—É—Å–æ—Ä.
std::cout << ref; // Undefined Behavior (Crash –∏–ª–∏ –º—É—Å–æ—Ä)
```

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç—è –±—ã –ø—Ä–∏–º–µ—Ä–Ω–æ –∑–Ω–∞–µ—Ç–µ, —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –≤ –≤–µ–∫—Ç–æ—Ä–µ, –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `reserve()`.

```c++
std::vector<User> users;
users.reserve(1000); // –°—Ä–∞–∑—É –≤—ã–¥–µ–ª—è–µ–º –ø–∞–º—è—Ç—å –ø–æ–¥ 1000 –º–µ—Å—Ç

// –¢–µ–ø–µ—Ä—å –ø–µ—Ä–≤—ã–µ 1000 push_back –±—É–¥—É—Ç –¥–µ—à–µ–≤—ã–º–∏
// –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–µ –≤—ã–∑–æ–≤—É—Ç —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–∏.
```

–ò—Ç–æ–≥: `std::vector` —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–æ –∑–∞ –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–ª–∞—Ç–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä. –ü–æ–º–æ–≥–∞–π—Ç–µ –µ–º—É —á–µ—Ä–µ–∑ `reserve()`, —á—Ç–æ–±—ã –∫–æ–¥ –±—ã–ª –±—ã—Å—Ç—Ä—ã–º –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º.